(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{620:function(e,t,a){var r=a(9),n=a(621);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};r(n,o);e.exports=n.locals||{}},621:function(e,t,a){e.exports={map__search__container:"map__search__container",map__search__title__container:"map__search__title__container",map__search__title:"map__search__title",map__search__form:"map__search__form",map__search__advanced__link:"map__search__advanced__link","map__search__advanced__link--close":"map__search__advanced__link--close",map__search__form__input__container:"map__search__form__input__container",map__search__form__input:"map__search__form__input",map__search__form__range__container:"map__search__form__range__container"}},640:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(12),c=a(1),s=a.n(c),i=a(64),p=a(416),l=a(97),u=a(14),m=a.n(u),h=a(15),f=a.n(h),_=a(74),d=a(26),y=a(25),b=a(31),v=a(7);a(620);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){O(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=D(e);if(t){var n=D(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return k(this,a)}}function k(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var F=function(e){var t=e.getDate();t<10&&(t="0".concat(t));var a=e.getMonth()+1;a<10&&(a="0".concat(a));var r=e.getFullYear();return"".concat(r,"-").concat(a,"-").concat(t)},T=new _.a,C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(c,e);var t,a,r,o=M(c);function c(){var e;w(this,c);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return(e=o.call.apply(o,[this].concat(a))).state={controls:{gender:{id:"gender",elementType:"select",value:"mapSearch.man",label:"MainPage.seeking",elementConfig:{options:["mapSearch.man","mapSearch.woman"]}},city:{id:"city",elementType:"input",label:"MainPage.map.city",value:"",coordinates:{},elementConfig:{type:"text"}},searchFrom:{id:"searchFrom",elementType:"input",value:"",label:"MainPage.from",elementConfig:{type:"number"}},searchTo:{id:"searchTo",elementType:"input",value:"",label:"MainPage.to",elementConfig:{type:"number"}},distance:{id:"distance",elementType:"range",value:0,label:"MainPage.map.distance",elementConfig:{type:"range",min:"0",max:"100",step:"1"}}},classes:"map__search__form__input__container"},e.inputChangedHandler=function(t,a){var r=t.target.value,n=e.props.mainParameters,o=e.state.controls;o[a].value=r,n[a]=r,"city"===a&&""!==r&&T.search({query:r}).then((function(e){o.city.coordinates={lat:e[0].y,lng:e[0].x},n.city=r,n.center={lat:e[0].y,lng:e[0].x}})),e.props.updateMainState({mainParameters:n}),e.setState({controls:o})},e.search=function(t){t.preventDefault();var a=P({},e.state.controls),r=e.props.coordinates,n=r.lat,o=r.lng,c=[];if(""!==a.city.value&&(c.push('city = "'.concat(a.city.value,'"')),n=e.state.controls.city.coordinates.lat,o=e.state.controls.city.coordinates.lng),"mapSearch.woman"===a.gender.value?c.push('gender = "female"'):c.push('gender = "male"'),""!==a.searchFrom.value){var s=new Date(Date.now());s.setFullYear(s.getFullYear()-a.searchFrom.value);var i=F(s);c.push('birthday <= "'.concat(i,'"'))}if(""!==a.searchTo.value){var p=new Date(Date.now());p.setFullYear(p.getFullYear()-a.searchTo.value);var l=F(p);c.push('birthday >= "'.concat(l,'"'))}var u={parameters:c.join(" AND "),distance:a.distance.value,lat:n,lng:o};m()({method:"post",url:"./mapsearch",data:f.a.stringify(u),headers:{Authorization:"Bearer ".concat(e.props.user.token)}}).then((function(t){e.props.updateMainState({users:t.data.users,center:{lat:n,lng:o}})})).catch((function(t){e.props.addError(t.response.data.message)}))},e}return t=c,(a=[{key:"componentDidUpdate",value:function(e){this.props.parametersFromMain!==e.parametersFromMain&&(this.setState({controls:this.props.parametersFromMain}),this.props.clearMapParameters())}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.controls);return n.a.createElement("div",{className:"map__search__container"},n.a.createElement("div",{className:"map__search__title__container"},n.a.createElement("h3",{className:"map__search__title"},n.a.createElement(l.a,null,"mapSearch.find")),n.a.createElement("img",{src:b.a,alt:""})),n.a.createElement("form",{className:"map__search__form"},t.map((function(t){return n.a.createElement(d.a,{key:e.state.controls[t].id,id:e.state.controls[t].id,elementType:e.state.controls[t].elementType,elementConfig:e.state.controls[t].elementConfig,value:e.state.controls[t].value,label:e.state.controls[t].label,changed:function(a){return e.inputChangedHandler(a,e.state.controls[t].id)},conteinerClasses:"distance"===t?"map__search__form__range__container":e.state.classes,labelClassName:"map__search__form__label",inputClassname:"distance"===t?"":"map__search__form__input"})})),n.a.createElement(y.a,{type:"submit",classes:"redButton",clicked:this.search},"MainPage.search")),n.a.createElement("a",{className:this.props.advancedSearch?"map__search__advanced__link":"map__search__advanced__link--close",onClick:this.props.showHideSearch},this.props.advancedSearch?n.a.createElement(l.a,null,"mapSearch.closeAdvancedSearch"):n.a.createElement(l.a,null,"mapSearch.advancedSearch")))}}])&&j(t.prototype,a),r&&j(t,r),c}(r.Component),R={clearMapParameters:v.i,addError:v.c};C.propTypes={showHideSearch:s.a.func,advancedSearch:s.a.bool,user:s.a.shape({id:s.a.number,token:s.a.string}),updateMainState:s.a.func,coordinates:s.a.shape({lat:s.a.number,lng:s.a.number}),mainParameters:s.a.shape(),parametersFromMain:s.a.shape(),clearMapParameters:s.a.func,addError:s.a.func};var x=Object(o.b)((function(e){return{user:e.user,coordinates:e.coordinates}}),R)(C),H=a(16),N=a(88);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function B(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(a),!0).forEach((function(t){J(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function J(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=G(e);if(t){var n=G(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return I(this,a)}}function I(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var K=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(c,e);var t,a,r,o=z(c);function c(){var e;L(this,c);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return(e=o.call.apply(o,[this].concat(a))).state={isLoaded:!0,users:[],advancedSearch:!1,center:{lat:0,lng:0},parameters:"",mainParameters:{gender:"mapSearch.man",city:"",center:{lat:e.props.coordinates.lat,lng:e.props.coordinates.lng},searchFrom:"",searchTo:"",distance:0},parametersFromMain:{}},e.updateMainState=function(t){e.setState(B({},t))},e.showHideSearch=function(){e.setState((function(e){return{advancedSearch:!e.advancedSearch}}))},e}return t=c,(a=[{key:"componentDidMount",value:function(){if(this.props.mapSearchParameters.users.length>0){var e=this.state.mainParameters,t=this.state.parametersFromMain;e.city=this.props.mapSearchParameters.parameters.city.value,e.center=this.props.mapSearchParameters.parameters.city.coordinates,e.gender=this.props.mapSearchParameters.parameters.gender.value,e.searchFrom=this.props.mapSearchParameters.parameters.searchFrom.value,e.searchTo=this.props.mapSearchParameters.parameters.searchTo.value,e.distance=this.props.mapSearchParameters.parameters.distance.value,t=this.props.mapSearchParameters.parameters,this.setState({users:this.props.mapSearchParameters.users,mainParameters:e,parametersFromMain:t})}this.props.mapSearchParameters.parameters.city&&this.props.mapSearchParameters.parameters.city.coordinates.lat&&""!==this.props.mapSearchParameters.parameters.city.value?this.setState({center:{lat:this.props.mapSearchParameters.parameters.city.coordinates.lat,lng:this.props.mapSearchParameters.parameters.city.coordinates.lng}}):this.setState({center:{lat:this.props.coordinates.lat,lng:this.props.coordinates.lng}})}},{key:"componentDidUpdate",value:function(e){this.props.coordinates.lat!==e.coordinates.lat&&this.setState({center:{lat:this.props.coordinates.lat,lng:this.props.coordinates.lng}})}},{key:"render",value:function(){var e=n.a.createElement(n.a.Fragment,null,n.a.createElement(i.a,{title:"mapSearch.title",subTittle:"advancedSearch.mainTitle"}),n.a.createElement(x,{showHideSearch:this.showHideSearch,advancedSearch:this.state.advancedSearch,updateMainState:this.updateMainState,mainParameters:this.state.mainParameters,parametersFromMain:this.state.parametersFromMain}),this.state.advancedSearch?n.a.createElement(p.a,{updateMainState:this.updateMainState,users:this.state.users,type:"map",mainParameters:this.state.mainParameters,center:this.state.center}):null,n.a.createElement(N.a,{users:this.state.users,center:this.state.center}));return this.state.isLoaded?e:n.a.createElement(H.a,null)}}])&&U(t.prototype,a),r&&U(t,r),c}(r.Component);K.propTypes={isAuthenticated:s.a.bool,user:s.a.shape({userId:s.a.string,token:s.a.string}),lng:s.a.shape({short:s.a.string}),coordinates:s.a.shape(),mapSearchParameters:s.a.shape()};t.default=Object(o.b)((function(e){return{user:e.user,lng:e.lng,coordinates:e.coordinates,mapSearchParameters:e.mapSearchParameters}}),{})(K)}}]);
//# sourceMappingURL=13.bundle.js.map